"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SearchService = void 0;
const ecs = require("aws-cdk-lib/aws-ecs");
const iam = require("aws-cdk-lib/aws-iam");
const aws_ecr_assets_1 = require("aws-cdk-lib/aws-ecr-assets");
const ecs_service_1 = require("./ecs-service");
class SearchService extends ecs_service_1.EcsService {
    constructor(scope, id, props) {
        super(scope, id, props);
        this.taskDefinition.taskRole?.addManagedPolicy(iam.ManagedPolicy.fromManagedPolicyArn(this, 'AmazonDynamoDBReadOnlyAccess', 'arn:aws:iam::aws:policy/AmazonDynamoDBReadOnlyAccess'));
        this.taskDefinition.taskRole?.addManagedPolicy(iam.ManagedPolicy.fromManagedPolicyArn(this, 'AmazonS3ReadOnlyAccess', 'arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess'));
    }
    containerImageFromRepository(repositoryURI) {
        return ecs.ContainerImage.fromRegistry(`${repositoryURI}/pet-search-java:latest`);
    }
    createContainerImage() {
        return ecs.ContainerImage.fromDockerImageAsset(new aws_ecr_assets_1.DockerImageAsset(this, "search-service", {
            directory: "./resources/microservices/petsearch-java"
        }));
    }
}
exports.SearchService = SearchService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLXNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzZWFyY2gtc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSwyQ0FBMkM7QUFDM0MsMkNBQTJDO0FBQzNDLCtEQUE4RDtBQUM5RCwrQ0FBMkQ7QUFHM0QsTUFBYSxhQUFjLFNBQVEsd0JBQVU7SUFFM0MsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFzQjtRQUM5RCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLElBQUksRUFBRSw4QkFBOEIsRUFBRSxzREFBc0QsQ0FBQyxDQUFDLENBQUM7UUFDckwsSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsZ0RBQWdELENBQUMsQ0FBQyxDQUFDO0lBQzNLLENBQUM7SUFFRCw0QkFBNEIsQ0FBQyxhQUFxQjtRQUNoRCxPQUFPLEdBQUcsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLEdBQUcsYUFBYSx5QkFBeUIsQ0FBQyxDQUFBO0lBQ25GLENBQUM7SUFFRCxvQkFBb0I7UUFDbEIsT0FBTyxHQUFHLENBQUMsY0FBYyxDQUFDLG9CQUFvQixDQUFDLElBQUksaUNBQWdCLENBQUMsSUFBSSxFQUFDLGdCQUFnQixFQUFFO1lBQ3pGLFNBQVMsRUFBRSwwQ0FBMEM7U0FDdEQsQ0FBQyxDQUFDLENBQUE7SUFDTCxDQUFDO0NBQ0Y7QUFsQkQsc0NBa0JDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZWNzIGZyb20gJ2F3cy1jZGstbGliL2F3cy1lY3MnO1xyXG5pbXBvcnQgKiBhcyBpYW0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XHJcbmltcG9ydCB7IERvY2tlckltYWdlQXNzZXQgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZWNyLWFzc2V0cyc7XHJcbmltcG9ydCB7IEVjc1NlcnZpY2UsIEVjc1NlcnZpY2VQcm9wcyB9IGZyb20gJy4vZWNzLXNlcnZpY2UnXHJcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnXHJcblxyXG5leHBvcnQgY2xhc3MgU2VhcmNoU2VydmljZSBleHRlbmRzIEVjc1NlcnZpY2Uge1xyXG5cclxuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogRWNzU2VydmljZVByb3BzICApIHtcclxuICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xyXG5cclxuICAgIHRoaXMudGFza0RlZmluaXRpb24udGFza1JvbGU/LmFkZE1hbmFnZWRQb2xpY3koaWFtLk1hbmFnZWRQb2xpY3kuZnJvbU1hbmFnZWRQb2xpY3lBcm4odGhpcywgJ0FtYXpvbkR5bmFtb0RCUmVhZE9ubHlBY2Nlc3MnLCAnYXJuOmF3czppYW06OmF3czpwb2xpY3kvQW1hem9uRHluYW1vREJSZWFkT25seUFjY2VzcycpKTtcclxuICAgIHRoaXMudGFza0RlZmluaXRpb24udGFza1JvbGU/LmFkZE1hbmFnZWRQb2xpY3koaWFtLk1hbmFnZWRQb2xpY3kuZnJvbU1hbmFnZWRQb2xpY3lBcm4odGhpcywgJ0FtYXpvblMzUmVhZE9ubHlBY2Nlc3MnLCAnYXJuOmF3czppYW06OmF3czpwb2xpY3kvQW1hem9uUzNSZWFkT25seUFjY2VzcycpKTtcclxuICB9XHJcblxyXG4gIGNvbnRhaW5lckltYWdlRnJvbVJlcG9zaXRvcnkocmVwb3NpdG9yeVVSSTogc3RyaW5nKSA6IGVjcy5Db250YWluZXJJbWFnZSB7XHJcbiAgICByZXR1cm4gZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeShgJHtyZXBvc2l0b3J5VVJJfS9wZXQtc2VhcmNoLWphdmE6bGF0ZXN0YClcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNvbnRhaW5lckltYWdlKCkgOiBlY3MuQ29udGFpbmVySW1hZ2Uge1xyXG4gICAgcmV0dXJuIGVjcy5Db250YWluZXJJbWFnZS5mcm9tRG9ja2VySW1hZ2VBc3NldChuZXcgRG9ja2VySW1hZ2VBc3NldCh0aGlzLFwic2VhcmNoLXNlcnZpY2VcIiwge1xyXG4gICAgICBkaXJlY3Rvcnk6IFwiLi9yZXNvdXJjZXMvbWljcm9zZXJ2aWNlcy9wZXRzZWFyY2gtamF2YVwiXHJcbiAgICB9KSlcclxuICB9XHJcbn1cclxuIl19